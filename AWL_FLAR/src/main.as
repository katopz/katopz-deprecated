package{	import away3dlite.containers.ObjectContainer3D;	import away3dlite.events.Loader3DEvent;	import away3dlite.loaders.Collada;	import away3dlite.loaders.Loader3D;		import com.greensock.TweenLite;	import com.greensock.plugins.AutoAlphaPlugin;	import com.greensock.plugins.TweenPlugin;	import com.sleepydesign.system.SystemUtil;	import com.squidder.flar.AWLFLARBaseApplication;	import com.squidder.flar.FLARMarkerObj;		import flash.display.Sprite;	import flash.display.StageDisplayState;	import flash.display.StageScaleMode;	import flash.events.ContextMenuEvent;	import flash.geom.Matrix3D;		import org.libspark.flartoolkit.support.away3dlite.FLARCamera3D;	//160,90	//320,180	//640,360	//1920,1080	[SWF(backgroundColor="#000000", frameRate="30", width="640", height="480")]	public class main extends AWLFLARBaseApplication	{		private var _model:ObjectContainer3D;		private var _container:ObjectContainer3D;				private var _isInit:Boolean = false;				override protected function onInit():void		{			debug = false;			view.mouseEnabled3D = false;			mouseEnabled = mouseChildren = false;			scene.addChild(_container = new ObjectContainer3D);			var _collada:Collada = new Collada();			_collada.bothsides = false;			_collada.scaling = 4;			var _loader:Loader3D = new Loader3D();			_loader.addEventListener(Loader3DEvent.LOAD_SUCCESS, onSuccess);			_loader.loadGeometry("assets/model.dae", _collada);			_container.addChild(_loader);			_loader.layer = new Sprite();			view.addChild(_loader.layer);						stage.scaleMode = StageScaleMode.SHOW_ALL;						SystemUtil.addContext(this, "Toggle Fullscreen", onClick);			SystemUtil.addContext(this, "Increase Size", onIncrease);			SystemUtil.addContext(this, "Decrease Size", onDecrease);		}		private function onIncrease(event:ContextMenuEvent):void		{			_model.scaleZ+=.25;			_model.scaleX = _model.scaleY = _model.scaleZ;		}				private function onDecrease(event:ContextMenuEvent):void		{			_model.scaleZ-=.25;			_model.scaleX = _model.scaleY = _model.scaleZ;		}				private function onClick(event:ContextMenuEvent):void		{			if(stage.displayState != StageDisplayState.FULL_SCREEN)				stage.displayState = StageDisplayState.FULL_SCREEN;			else				stage.displayState = StageDisplayState.NORMAL;		}				private function onSuccess(event:Loader3DEvent):void		{			_model = event.target.handle as ObjectContainer3D;			//_model.x = -50;			_model.rotationZ = 90;						_model.layer.alpha = 0;			_model.layer.visible = false;		}		override protected function onPreRender():void		{			if (_model)				_model.rotationY++;		}		public function onLite():void		{			if (_isInit)				return;			_isInit = true;						view.camera = camera = new FLARCamera3D(_flarParam, 2);			camera.projection.fieldOfView = 60;			camera.focus = 10;			camera.zoom = 40;			camera.z = 0;			view.setSize(_customWidth, _customHeight);						var debugRect:Sprite = new Sprite();			debugRect.graphics.lineStyle(1, 0xFF0000);			debugRect.graphics.drawRect(0, 0, _customWidth, _customHeight);			debugRect.graphics.endFill();						//addChild(debugRect);		}		public function main()		{			TweenPlugin.activate([AutoAlphaPlugin]);						_markers = [];			//_markers.push( new FLARMarkerObj( "assets/flar/crash.pat" , 16 , 50 , 80 ) );			//_markers.push( new FLARMarkerObj( "assets/flar/kickdrum.pat" , 16 , 50 , 80 ) );			//_markers.push( new FLARMarkerObj( "assets/flar/ride.pat" , 16 , 50 , 80 ) );			//_markers.push( new FLARMarkerObj( "assets/flar/snare64.pat" , 64 , 100 , 100 ) );			_markers.push(new FLARMarkerObj("flars/marker64.pat", 64, 100, 100));			super();		}		override protected function _detectMarkers():void		{			_resultsArray = _flarDetector.updateMarkerPosition(_flarRaster, 80, .5);						if (_resultsArray.length > 0)			{				_flarDetector.getTransmationMatrix(_resultsArray[0][0], _resultMat);				_container.transform.matrix3D.interpolateTo(new Matrix3D(transformMatrixLite(_resultMat)), .1);				if (_model)				{					//_model.visible = true;					TweenLite.to(_model.layer, 1, {autoAlpha:1});				}			}			else			{				if (_model)				{					//_model.visible = false;					TweenLite.to(_model.layer, 1, {autoAlpha:0});				}			}			if (camera && camera.root != null)				onLite();		}		}}